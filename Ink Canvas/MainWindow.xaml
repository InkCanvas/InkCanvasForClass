<Window Name="window" x:Class="Ink_Canvas.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Ink_Canvas"
        xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
        xmlns:c="clr-namespace:Ink_Canvas.Converter"
        xmlns:Controls="http://schemas.microsoft.com/netfx/2009/xaml/presentation"
        mc:Ignorable="d"
        AllowsTransparency="True"
        WindowStyle="None"
        ResizeMode="NoResize"
        WindowState="Maximized"
        Loaded="Window_Loaded"
        Background="Transparent"
        ShowInTaskbar="False"
        Title="Ink Canvas 画板"
        Topmost="True"
        KeyDown="Window_KeyDown"
        Closing="Window_Closing"
        Closed="Window_Closed"
        PreviewKeyDown="Main_Grid_PreviewKeyDown"
        Height="7000" Width="1440"
        FontFamily="Microsoft YaHei UI"
        MouseWheel="Window_MouseWheel"
        Foreground="Black"
        Stylus.IsPressAndHoldEnabled="False">
    <!--资源中添加命令-->
    <Window.Resources>
        <c:VisibilityConverter x:Key="VisibilityConverter"/>
        <c:IsEnabledToOpacityConverter x:Key="IsEnabledToOpacityConverter"/>
        <RoutedUICommand x:Key="KeyExit" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Command_Undo" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Command_Redo" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Command_Clear" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Capture" Text=" "/>
        <RoutedUICommand x:Key="HotKey_Hide" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToDrawTool" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToQuitDrawTool" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToSelect" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToEraser" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToBoard" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen1" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen2" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen3" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen4" Text=" "/>
        <RoutedUICommand x:Key="HotKey_ChangeToPen5" Text=" "/>
        <RoutedUICommand x:Key="HotKey_DrawLine" Text=" "/>
    </Window.Resources>
    <!--输入命令绑定-->
    <Window.InputBindings>
        <KeyBinding Gesture="Shift+Esc" Command="{StaticResource KeyExit}"/>
        <KeyBinding Modifiers="Control" Key="Z" Command="{StaticResource HotKey_Command_Undo}"/>
        <KeyBinding Modifiers="Control" Key="Y" Command="{StaticResource HotKey_Command_Redo}"/>
        <KeyBinding Modifiers="Control" Key="E" Command="{StaticResource HotKey_Command_Clear}" />
        <KeyBinding Modifiers="Alt" Key="C" Command="{StaticResource HotKey_Capture}" />
        <KeyBinding Modifiers="Alt" Key="V" Command="{StaticResource HotKey_Hide}" />
        <KeyBinding Modifiers="Alt" Key="S" Command="{StaticResource HotKey_ChangeToSelect}" />
        <KeyBinding Modifiers="Alt" Key="D" Command="{StaticResource HotKey_ChangeToDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="Q" Command="{StaticResource HotKey_ChangeToQuitDrawTool}" />
        <KeyBinding Modifiers="Alt" Key="E" Command="{StaticResource HotKey_ChangeToEraser}" />
        <KeyBinding Modifiers="Alt" Key="B" Command="{StaticResource HotKey_ChangeToBoard}" />
        <KeyBinding Modifiers="Alt" Key="D1" Command="{StaticResource HotKey_ChangeToPen1}" />
        <KeyBinding Modifiers="Alt" Key="D2" Command="{StaticResource HotKey_ChangeToPen2}" />
        <KeyBinding Modifiers="Alt" Key="D3" Command="{StaticResource HotKey_ChangeToPen3}" />
        <KeyBinding Modifiers="Alt" Key="D4" Command="{StaticResource HotKey_ChangeToPen4}" />
        <KeyBinding Modifiers="Alt" Key="D5" Command="{StaticResource HotKey_ChangeToPen5}" />
        <KeyBinding Modifiers="Alt" Key="L" Command="{StaticResource HotKey_DrawLine}" />
    </Window.InputBindings>
    <!--命令执行方法绑定-->
    <Window.CommandBindings>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource KeyExit}" Executed="KeyExit"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Undo}" Executed="HotKey_Undo"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Redo}" Executed="HotKey_Redo"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Command_Clear}" Executed="HotKey_Clear"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToDrawTool}" Executed="KeyChangeToDrawTool"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToQuitDrawTool}" Executed="KeyChangeToQuitDrawTool"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToSelect}" Executed="KeyChangeToSelect"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToEraser}" Executed="KeyChangeToEraser"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_ChangeToBoard}" Executed="KeyChangeToBoard"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Capture}" Executed="KeyCapture"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_Hide}" Executed="KeyHide"/>
        <CommandBinding CanExecute="CommandBinding_CanExecute" Command="{StaticResource HotKey_DrawLine}" Executed="KeyDrawLine"/>
    </Window.CommandBindings>

    <Grid x:Name="Main_Grid" Background="#01FFFFFF">
        <!--// 黑/白 板幕布 //-->
        <Grid Name="GridBackgroundCoverHolder">
            <Grid Name="GridBackgroundCover" Visibility="Collapsed" Background="#1F1F1F"/>
        </Grid>

        <Canvas Name="Canvas"/>
        <Label Name="Label" Visibility="Collapsed" Foreground="Gray" Content="0"/>
        <InkCanvas x:Name="inkCanvas" Background="Transparent" Cursor="Pen" ForceCursor="False"
                   TouchUp="Main_Grid_TouchUp" TouchDown="Main_Grid_TouchDown"
                   TouchMove="inkCanvas_TouchMove"
                   ManipulationDelta="Main_Grid_ManipulationDelta"
                   ManipulationCompleted="Main_Grid_ManipulationCompleted"
                   ManipulationInertiaStarting="inkCanvas_ManipulationInertiaStarting"
                   IsManipulationEnabled="True"
                   EditingModeChanged="inkCanvas_EditingModeChanged"
                   PreviewTouchDown="inkCanvas_PreviewTouchDown"
                   PreviewTouchUp="inkCanvas_PreviewTouchUp"
                   MouseDown="inkCanvas_MouseDown"
                   MouseMove="inkCanvas_MouseMove"
                   MouseUp="inkCanvas_MouseUp"
                   ManipulationStarting="inkCanvas_ManipulationStarting"
                   SelectionChanged="inkCanvas_SelectionChanged"
                   StrokeCollected="inkCanvas_StrokeCollected"/>
        <Grid Visibility="{Binding ElementName=inkCanvas, Path=Visibility}">
            <Grid Name="GridInkCanvasSelectionCover"
                  MouseDown="GridInkCanvasSelectionCover_MouseDown"
                  MouseUp="GridInkCanvasSelectionCover_MouseUp"
                  IsManipulationEnabled="True"
                  ManipulationStarting="GridInkCanvasSelectionCover_ManipulationStarting"
                  ManipulationCompleted="GridInkCanvasSelectionCover_ManipulationCompleted"
                  ManipulationDelta="GridInkCanvasSelectionCover_ManipulationDelta"
                  PreviewTouchDown="GridInkCanvasSelectionCover_PreviewTouchDown"
                  PreviewTouchUp="GridInkCanvasSelectionCover_PreviewTouchUp"
                  TouchDown="GridInkCanvasSelectionCover_TouchDown"
                  TouchUp="GridInkCanvasSelectionCover_TouchUp"
                  Background="#01FFFFFF" Opacity="0.01" Visibility="Visible" Margin="1,0,-1,0"/>
            <Border Name="BorderStrokeSelectionControl"
                    HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,900,0,0"
                    CornerRadius="5" Height="80"
                    Background="{DynamicResource FloatBarBackground}" Visibility="{Binding ElementName=GridInkCanvasSelectionCover, Path=Visibility}"
                    BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                <Viewbox Margin="0,-2.5">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10" Height="60">
                        <Border Name="BorderStrokeSelectionClone" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionClone_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_copy_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                <TextBlock Text="克隆" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Name="BorderStrokeSelectionCloneToNewBoard" Margin="0,2,-9,2" Background="Transparent" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}"
                                Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionCloneToNewBoard_MouseUp" Visibility="{Binding Visibility, ElementName=GridBackgroundCover}">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_copy_add_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                <TextBlock Text="克隆至新页" FontSize="8" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                    <Image Source="{DynamicResource Rotate45DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate45_MouseUp"/>
                                    <Image Source="{DynamicResource Rotate90DrawingImage}" Height="22" MouseDown="Border_MouseDown" MouseUp="ImageRotate90_MouseUp"/>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="旋转" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal">
                                    <Image MouseDown="Border_MouseDown" MouseUp="ImageFlipHorizontal_MouseUp" Source="/Resources/Icons-Fluent/ic_fluent_flip_horizontal_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30"/>
                                    <Image MouseDown="Border_MouseDown" MouseUp="ImageFlipVertical_MouseUp" Source="/Resources/Icons-Fluent/ic_fluent_flip_vertical_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30"/>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="翻转" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Height="40">
                            <ui:SimpleStackPanel VerticalAlignment="Center" Spacing="5" Margin="0,-10">
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthDecrease_MouseUp">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_edit_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                        <TextBlock Text="-"  Foreground="{DynamicResource FloatBarForeground}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-2,-7" FontSize="15"/>
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthIncrease_MouseUp">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_edit_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                        <TextBlock Text="+"  Foreground="{DynamicResource FloatBarForeground}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-3,-4" FontSize="11"/>
                                    </Grid>
                                    <Grid MouseDown="Border_MouseDown" MouseUp="GridPenWidthRestore_MouseUp">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_edit_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                        <Image Source="{DynamicResource AndroidRefreshDrawingImage}" VerticalAlignment="Bottom" HorizontalAlignment="Right" Margin="0,0,-2,-2" Width="8"/>
                                    </Grid>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="画笔粗细" FontSize="10" HorizontalAlignment="Center" Foreground="{DynamicResource FloatBarForeground}"/>
                            </ui:SimpleStackPanel>
                        </Border>
                        <Border Width="1" Height="45" BorderBrush="{DynamicResource FloatBarForeground}" Background="{DynamicResource FloatBarForeground}"/>
                        <Border Margin="-8,0,0,0" CornerRadius="{Binding ElementName=BorderStrokeSelectionControl, Path=CornerRadius}" Width="40" MouseDown="Border_MouseDown" MouseUp="BorderStrokeSelectionDelete_MouseUp">
                            <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_delete_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                <TextBlock Margin="0,5,0,0" Text="删除" FontSize="10" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center"/>
                            </ui:SimpleStackPanel>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Border>
        </Grid>

        <Grid Visibility="Collapsed">
            <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
                <Viewbox Margin="10" Height="50" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="5">
                        <Border Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlPrevious_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" />
                            </Grid>
                        </Border>
                        <Border Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6" MouseUp="GridPPTControlNext_MouseUp">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>

        <!--// BlackBoard 界面 //-->
        <Grid Visibility="{Binding ElementName=GridBackgroundCoverHolder, Path=Visibility}">
            <!-- 左下角 -->
            <Viewbox x:Name="ViewboxBlackboardLeftSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardLeftSideScaleTransform" ScaleX="1" ScaleY="1"/>
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardLeftSide" Visibility="Visible" Opacity="0.75" Margin="3,0,0,0" Height="55" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal">
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BtnWhiteBoardSwitchPrevious_Click" CornerRadius="5,0,0,5" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_arrow_circle_left_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality"  VerticalAlignment="Top" Width="26" Height="26"/>

                                <TextBlock Text="上一页" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Width="58" Height="55" Background="LightGray" Opacity="0.85">
                            <Grid Margin="0,6">
                                <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Margin="0,4,0,2" Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}" Foreground="Black" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="15"/>
                                    <TextBlock Margin="0,3,0,0" Text="页码" Foreground="Black" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="12"/>
                                </ui:SimpleStackPanel>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BtnWhiteBoardSwitchNext_Click" CornerRadius="0,5,5,0" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image x:Name="BoardLeftPannelNextPage" Source="/Resources/Icons-Fluent/ic_fluent_add_circle_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock x:Name="BoardLeftPannelNextPageTextBlock" Text="加页" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Margin="5,0,0,0" Width="55" Height="55" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp" CornerRadius="5" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-png/minimize.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock Text="退出" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Grid>
            </Viewbox>
            <!-- 中间 -->
            <Viewbox x:Name="ViewboxBlackboardCenterSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Center" VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardCenterSideScaleTransform" ScaleX="1" ScaleY="1"/>
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardCenterSide" Visibility="Visible" Opacity="0.8" Margin="0" Height="55" HorizontalAlignment="Center" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal">
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="TwoFingerGestureBorder_MouseUp" CornerRadius="5,0,0,5" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image x:Name="BoardEnableTwoFingerGestureBtn" VerticalAlignment="Top" Source="/Resources/Icons-png/twoFingelMove.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                <TextBlock Text="手势" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Grid Margin="0,0,0,5" Width="0">
                            <Border Name="BoardTwoFingerGestureBorder" Margin="-115,-152,-55,54" CornerRadius="5" Background="LightGray" Opacity="0.85" BorderBrush="Black" BorderThickness="1">
                                <ui:SimpleStackPanel Margin="10">
                                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_people_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                        <Label Content="多指书写" FontSize="15" VerticalAlignment="Center"/>
                                        <ui:ToggleSwitch MinWidth="0" Width="42" Name="BoardToggleSwitchEnableMultiTouchMode" FontFamily="Microsoft YaHei UI" IsOn="False" OnContent="" OffContent="" Toggled="ToggleSwitchEnableMultiTouchMode_Toggled"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_drag_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                        <Label Content="双指移动" FontSize="15" VerticalAlignment="Center"/>
                                        <ui:ToggleSwitch MinWidth="0" Width="42" Name="BoardToggleSwitchEnableTwoFingerTranslate" FontFamily="Microsoft YaHei UI" IsOn="False" OnContent="" OffContent="" Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_scale_fit_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                        <Label Content="双指缩放" FontSize="15" VerticalAlignment="Center"/>
                                        <ui:ToggleSwitch MinWidth="0" Width="42" Name="BoardToggleSwitchEnableTwoFingerZoom" FontFamily="Microsoft YaHei UI" IsOn="False" OnContent="" OffContent="" Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_arrow_rotate_clockwise_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                        <Label Content="双指旋转" FontSize="15" VerticalAlignment="Center"/>
                                        <ui:ToggleSwitch MinWidth="0" Width="42" Name="BoardToggleSwitchEnableTwoFingerRotation" FontFamily="Microsoft YaHei UI" OnContent="" OffContent="" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                                    </ui:SimpleStackPanel>
                                </ui:SimpleStackPanel>
                            </Border>
                        </Grid>
                        <Border Margin="0,0,5,0" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BoardChangeBackgroundColorBtn_MouseUp" CornerRadius="0,5,5,0" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_dark_theme_24_regular.png" VerticalAlignment="Top" RenderOptions.BitmapScalingMode="HighQuality" Height="26" Width="26"/>

                                <TextBlock Text="画布" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardSelect" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="SymbolIconSelect_MouseUp" CornerRadius="5,0,0,5" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-Fluent/ic_fluent_lasso_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                <TextBlock Text="选择" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardPen" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="PenIcon_Click" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image x:Name="BoardPenIcon" VerticalAlignment="Top" Source="/Resources/Icons-Fluent/ic_fluent_signature_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                <TextBlock Text="墨迹" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border>
                            <Grid Margin="0,5,0,5" Width="0" RenderTransformOrigin="0.5,0.5">
                                <Border x:Name="BoardPenPalette" Visibility="Visible" Background="LightGray" Opacity="0.85" CornerRadius="5" BorderBrush="Black" BorderThickness="1" Margin="-150,-195,-100,55">
                                    <Viewbox>
                                        <StackPanel Margin="20 10">
                                            <Viewbox HorizontalAlignment="Center" VerticalAlignment="Center">
                                                <ui:SimpleStackPanel>
                                                    <Controls:UniformGrid Columns="2" Width="300" Height="55">
                                                        <ui:SimpleStackPanel Orientation="Horizontal" Height="35">
                                                            <Label Content="笔锋" Margin="0,0,12,0" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                            <ComboBox Height="30" VerticalAlignment="Center" Name="BoardComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                                                <ComboBoxItem Content="抬笔笔锋" FontFamily="Microsoft YaHei UI"/>
                                                                <ComboBoxItem Content="速度笔锋" FontFamily="Microsoft YaHei UI"/>
                                                                <ComboBoxItem Content="关闭笔锋" FontFamily="Microsoft YaHei UI"/>
                                                            </ComboBox>
                                                        </ui:SimpleStackPanel>
                                                        <ui:SimpleStackPanel Margin="0,-5,0,-5" VerticalAlignment="Center">
                                                            <ui:SimpleStackPanel x:Name="BoardNibModeSimpleStackPanel" Orientation="Horizontal" Width="140">
                                                                <Label Content="笔尖模式" FontSize="15" VerticalAlignment="Center"/>
                                                                <ui:ToggleSwitch x:Name="ToggleSwitchBoardEnableNibMode" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" MinWidth="0" Margin="10,0,0,0" Toggled="ToggleSwitchEnableNibMode_Toggled" IsOn="True"/>
                                                            </ui:SimpleStackPanel>
                                                            <ui:SimpleStackPanel Orientation="Horizontal" Width="140">
                                                                <Label Margin="0,0,10,0" Content="墨迹识别" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                                <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" MinWidth="0" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}"/>
                                                            </ui:SimpleStackPanel>
                                                        </ui:SimpleStackPanel>
                                                    </Controls:UniformGrid>


                                                    <StackPanel Orientation="Horizontal" Height="30">
                                                        <Label Margin="0,0,10,0" Content="粗细" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                        <Slider x:Name="BoardInkWidthSlider" Minimum="1" Maximum="15" Width="230" FontFamily="Microsoft YaHei UI" 
                                                            FontSize="20" IsSnapToTickEnabled="True" Value="5" TickFrequency="1" TickPlacement="None" ValueChanged="InkWidthSlider_ValueChanged"/>
                                                        <TextBlock Text="{Binding Value, ElementName=BoardInkWidthSlider, Mode=OneWay}" VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14"/>
                                                    </StackPanel>
                                                </ui:SimpleStackPanel>
                                            </Viewbox>
                                            <ui:SimpleStackPanel Width="300">
                                                <!--<TextBlock FontSize="25">画笔颜色</TextBlock>-->
                                                <Border Width="300" Height="130" BorderBrush="Black" BorderThickness="0" CornerRadius="5">
                                                    <Controls:UniformGrid Rows="2" Height="130">
                                                        <ui:SimpleStackPanel Height="55" Orientation="Horizontal" Width="270">
                                                            <Controls:UniformGrid Columns="4" Width="270">
                                                                <Border BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseDown="Border_MouseDown" MouseUp="ColorThemeSwitch_MouseUp">
                                                                    <Grid Margin="6">
                                                                        <Image x:Name="BoardColorThemeSwitchIcon" Source="/Resources/Icons-Fluent/ic_fluent_weather_sunny_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                                                        <TextBlock x:Name="BoardColorThemeSwitchTextBlock" Text="亮系" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                                                                    </Grid>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorBlack" Background="Black" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorBlack_Click">
                                                                    <Viewbox Name="BoardViewboxBtnColorBlackContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorWhite" Background="White" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorWhite_Click">
                                                                    <Viewbox x:Name="BoardViewboxBtnColorWhiteContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="Black"/>
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorRed" Background="red" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorRed_Click">
                                                                    <Viewbox Name="BoardViewboxBtnColorRedContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                            </Controls:UniformGrid>
                                                        </ui:SimpleStackPanel>
                                                        <ui:SimpleStackPanel Height="55" Orientation="Horizontal" Width="270">
                                                            <Controls:UniformGrid Columns="4" Width="270">
                                                                <Border x:Name="BoardBorderPenColorYellow" Background="#F38B00" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorYellow_Click">
                                                                    <Viewbox x:Name="BoardViewboxBtnColorYellowContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorGreen" Background="#169141" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorGreen_Click">
                                                                    <Viewbox Name="BoardViewboxBtnColorGreenContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorBlue" Background="#239AD6" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorBlue_Click">
                                                                    <Viewbox x:Name="BoardViewboxBtnColorBlueContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                                <Border x:Name="BoardBorderPenColorPink" Background="#c72ec7" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorPink_Click">
                                                                    <Viewbox x:Name="BoardViewboxBtnColorPinkContent" Visibility="Collapsed" Margin="6">
                                                                        <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                    </Viewbox>
                                                                </Border>
                                                            </Controls:UniformGrid>
                                                        </ui:SimpleStackPanel>
                                                    </Controls:UniformGrid>
                                                </Border>
                                            </ui:SimpleStackPanel>
                                        </StackPanel>
                                    </Viewbox>
                                </Border>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardEraser" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BoardEraserIcon_Click" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-png/eraser-outline.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                <TextBlock Text="面积擦" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Width="0" MouseDown="Border_MouseDown" MouseUp="BoardSymbolIconDelete_MouseUp">
                            <Border x:Name="BoardDeleteIcon" Margin="-61,-55,-61,55" Background="LightGray" Opacity="0.85" BorderBrush="Black" BorderThickness="1,1,1,0" CornerRadius="5,5,0,0">
                                <Grid>
                                    <ui:SimpleStackPanel Margin="6" Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_delete_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                        <TextBlock Margin="5,0,0,0" Text="点击清屏" Foreground="Black" VerticalAlignment="Center" FontSize="14"/>
                                    </ui:SimpleStackPanel>
                                </Grid>
                            </Border>
                        </Border>
                        <Border x:Name="BoardEraserByStrokes" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BoardEraserIconByStrokes_Click" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-png/eraser-line.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                <TextBlock Text="墨迹擦" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardGeometry" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="ImageDrawShape_MouseUp" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-Fluent/ic_fluent_shapes_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28"/>
                                <TextBlock Text="图形" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Width="0">
                            <Border x:Name="BoardBorderDrawShape" Visibility="Visible" Background="LightGray" Opacity="0.85" BorderBrush="Black" BorderThickness="1" CornerRadius="5" Margin="-147,-286,-89,59">
                                <Viewbox>
                                    <ui:SimpleStackPanel Spacing="-8" Orientation="Vertical">
                                        <TextBlock FontSize="16" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Left" Margin="10,8">
                                            <Run Text="图形"/>
                                            <Run Text="(第一行支持长按保持选中)" FontSize="10"/>
                                        </TextBlock>
                                        <ui:SymbolIcon Margin="0,-20,8,15" Symbol="Pin" MouseDown="Border_MouseDown" MouseUp="SymbolIconPinBorderDrawShape_MouseUp" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Right"/>
                                        <ui:SimpleStackPanel Margin="20,0,0,0" Orientation="Horizontal">
                                            <ui:SimpleStackPanel Visibility="Collapsed" Margin="58,6,5,6" Width="54">
                                                <Label Margin="0,0,0,-2" Content="自动隐藏" Foreground="{DynamicResource FloatBarForeground}" FontSize="13" VerticalAlignment="Center"/>
                                                <Viewbox Height="25">
                                                    <ui:ToggleSwitch Name="ToggleSwitchDrawShapeBorderAutoHide" Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" IsOn="True"/>
                                                </Viewbox>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                        <ui:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                            <Image Name="ImageDrawLine" Margin="16,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click" Source="{DynamicResource DrawShapeImageSource.Line}"/>
                                            <Image Name="ImageDrawDashedLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDashedLine_Click" Source="{DynamicResource DrawShapeImageSource.DashedLine}"/>
                                            <Image Name="ImageDrawDotLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click" Source="{DynamicResource DrawShapeImageSource.DotLine}"/>
                                            <Image Name="ImageDrawArrow" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click" Source="{DynamicResource DrawShapeImageSource.ArrowLine}"/>
                                            <Image Name="ImageDrawParallelLine" Margin="0,11.5,16,11.5" MouseDown="Image_MouseDown" MouseUp="BtnDrawParallelLine_Click" Source="{DynamicResource DrawShapeImageSource.ParallelLine}"/>
                                        </ui:SimpleStackPanel>
                                        <ui:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                            <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate1}"/>
                                            <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate2}"/>
                                            <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate3}"/>
                                            <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate4}"/>
                                            <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate5}"/>
                                        </ui:SimpleStackPanel>
                                        <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                            <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click" Source="{DynamicResource DrawShapeImageSource.RectangleCenter}"/>
                                            <Image Visibility="Collapsed" Margin="0,10" MouseUp="BtnDrawEllipse_Click" Source="{DynamicResource DrawShapeImageSource.Ellipse}"/>
                                            <Image Margin="0,10" MouseUp="BtnDrawCircle_Click" Source="{DynamicResource DrawShapeImageSource.Circle}"/>
                                            <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click" Source="{DynamicResource DrawShapeImageSource.DashedCircle}"/>
                                            <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenter}" Width="30"/>
                                            <Image Margin="0,10" MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenterWithFocalPoint}" Width="30"/>
                                        </ui:SimpleStackPanel>
                                        <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                            <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Hyperbola}"/>
                                            <Image Margin="4,10,2,10" MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.HyperbolaWithFocalPoint}"/>
                                            <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}"/>
                                            <Image Margin="1,10,2,10" MouseUp="BtnDrawParabolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.ParabolaWithFocalPoint}" RenderTransformOrigin="0.5,0.5">
                                                <Image.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform/>
                                                        <SkewTransform/>
                                                        <RotateTransform Angle="90"/>
                                                        <TranslateTransform/>
                                                    </TransformGroup>
                                                </Image.RenderTransform>
                                            </Image>
                                            <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}" RenderTransformOrigin="0.5,0.5">
                                                <Image.RenderTransform>
                                                    <TransformGroup>
                                                        <ScaleTransform/>
                                                        <SkewTransform/>
                                                        <RotateTransform Angle="90"/>
                                                        <TranslateTransform/>
                                                    </TransformGroup>
                                                </Image.RenderTransform>
                                            </Image>
                                        </ui:SimpleStackPanel>
                                        <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                            <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click" Source="{DynamicResource DrawShapeImageSource.Rectangle}"/>
                                            <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click" Source="{DynamicResource DrawShapeImageSource.Cylinder}"/>
                                            <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click" Source="{DynamicResource DrawShapeImageSource.Cone}"/>
                                            <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Cuboid}"/>
                                            <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Tetrahedron}"/>
                                        </ui:SimpleStackPanel>
                                    </ui:SimpleStackPanel>
                                </Viewbox>
                            </Border>
                        </Border>
                        <Border x:Name="BoardUndo" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="SymbolIconUndo_MouseUp" IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-png/undo.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="28"
                                       Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"/>
                                <TextBlock Text="撤销" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border x:Name="BoardRedo" Width="60" Height="55" CornerRadius="0,5,5,0" MouseDown="Border_MouseDown" MouseUp="SymbolIconRedo_MouseUp" IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-png/redo.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="28"
                                       Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"/>
                                <TextBlock Text="重做" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Margin="5,0,0,0" Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="SymbolIconTools_MouseUp" Background="LightGray" Opacity="0.85" CornerRadius="5,0,0,5">
                            <Grid Margin="6">
                                <Image VerticalAlignment="Top" Source="/Resources/Icons-png/setting.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="28"/>
                                <TextBlock Text="更多" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border>
                            <Grid Margin="0,0,0,5" Width="0">
                                <Border Name="BoardBorderTools" Margin="-162,-190,-102,54" CornerRadius="5" Background="LightGray" Opacity="0.85" BorderBrush="Black" BorderThickness="1">
                                    <ui:SimpleStackPanel Margin="13">
                                        <Border Margin="4,3" BorderBrush="Black" BorderThickness="1.5" Width="220" CornerRadius="10">
                                            <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                                                <ui:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="2.5,0,0,0" Height="35" Spacing="5" MouseDown="Border_MouseDown" MouseUp="BoardLaunchEasiCamera_MouseUp">
                                                    <Image Source="/Resources/Icons-png/EasiCamera.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25"/>
                                                    <TextBlock Text="视频展台" FontSize="15" VerticalAlignment="Center"/>
                                                </ui:SimpleStackPanel>
                                                <Line Margin="10,0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0" X2="0" Y2="25" Stroke="Black" StrokeThickness="1"/>
                                                <ui:SimpleStackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="2.5,0,0,0" Height="35" Spacing="5" MouseDown="Border_MouseDown" MouseUp="BoardLaunchDesmos_MouseUp">
                                                    <Image Margin="-1,0,0,0" Source="/Resources/Icons-png/Desmos.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25">
                                                        <Image.Clip>
                                                            <EllipseGeometry Center="12.5,12.5" RadiusX="12.5" RadiusY="12.5" />
                                                        </Image.Clip>
                                                    </Image>
                                                    <TextBlock Text="Desmos" FontSize="15" VerticalAlignment="Center"/>
                                                </ui:SimpleStackPanel>
                                            </ui:SimpleStackPanel>
                                        </Border>
                                        <Label Content="保存 | 打开 | 播放 — 当前页墨迹" FontSize="16" HorizontalAlignment="Left"/>
                                        <ui:SimpleStackPanel Orientation="Horizontal" Margin="2.5,0,0,0" Height="35" Spacing="15">
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_save_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="SymbolIconSaveStrokes_MouseUp"/>
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_folder_open_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="SymbolIconOpenStrokes_MouseUp"/>
                                            <Image Source="/Resources/Icons-png/playCircle.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="GridInkReplayButton_MouseUp"/>
                                        </ui:SimpleStackPanel>
                                        <Label Content="截图  设置 | 倒计时  随机抽选" FontSize="17" HorizontalAlignment="Left"/>
                                        <ui:SimpleStackPanel Orientation="Horizontal" Margin="2.5,0,0,0" Height="35" Spacing="14">
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_camera_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="SymbolIconScreenshot_MouseUp"/>
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_settings_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="SymbolIconSettings_Click"/>

                                            <Border Margin="-10,0,0,0" Width="1" Height="30" BorderBrush="Black" Background="Black"/>

                                            <Image Margin="-2,0,5,0" Source="/Resources/Icons-Fluent/ic_fluent_timer_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30" MouseDown="Border_MouseDown" MouseUp="ImageCountdownTimer_MouseUp"/>
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_people_money_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28" MouseDown="Border_MouseDown" MouseUp="SymbolIconRand_MouseUp"/>
                                            <Image Source="/Resources/Icons-Fluent/ic_fluent_person_money_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="28" Width="28" MouseDown="Border_MouseDown" MouseUp="SymbolIconRandOne_MouseUp"/>
                                        </ui:SimpleStackPanel>
                                    </ui:SimpleStackPanel>
                                </Border>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp" CornerRadius="0,5,5,0" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-png/minimize.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock Text="退出" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Grid>
            </Viewbox>
            <!-- 右下角 -->
            <Viewbox x:Name="ViewboxBlackboardRightSide" Margin="3,0,0,0" Height="55" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <Viewbox.LayoutTransform>
                    <ScaleTransform x:Name="ViewboxBlackboardRightSideScaleTransform" ScaleX="1" ScaleY="1"/>
                </Viewbox.LayoutTransform>
                <Grid x:Name="BlackboardRightSide" Visibility="Visible" Opacity="0.75" Margin="0,0,3,0" Height="55" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal">
                        <Border Margin="0,0,5,0" Width="55" Height="55" MouseDown="Border_MouseDown" MouseUp="BtnWhiteBoardAdd_Click" CornerRadius="3" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_add_circle_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock Text="加页" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BtnWhiteBoardSwitchPrevious_Click" CornerRadius="3,0,0,3" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_arrow_circle_left_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock Text="上一页" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                        <Border Width="58" Height="55" Background="LightGray" Opacity="0.85">
                            <Grid Margin="0,6">
                                <ui:SimpleStackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Margin="0,4,0,2" Text="{Binding ElementName=TextBlockWhiteBoardIndexInfo, Path=Text}" Foreground="Black" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="15"/>
                                    <TextBlock Margin="0,3,0,0" Text="页码" Foreground="Black" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="12"/>
                                </ui:SimpleStackPanel>
                            </Grid>
                        </Border>
                        <Border Width="60" Height="55" MouseDown="Border_MouseDown" MouseUp="BtnWhiteBoardSwitchNext_Click" CornerRadius="0,5,5,0" Background="LightGray" Opacity="0.85">
                            <Grid Margin="6">
                                <Image x:Name="BoardRightPannelNextPage" Source="/Resources/Icons-Fluent/ic_fluent_add_circle_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                <TextBlock x:Name="BoardRightPannelNextPageTextBlock" Text="加页" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="12"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Grid>
            </Viewbox>

            <ui:SimpleStackPanel Spacing="10" Orientation="Horizontal"
                 VerticalAlignment="Bottom"
                 HorizontalAlignment="Right"
                 Height="50" Margin="10"
                 Visibility="Collapsed">
                <Button Name="BtnWhiteBoardAdd" FontFamily="Microsoft YaHei UI"
        Width="50" Height="48" FontSize="26" Click="BtnWhiteBoardAdd_Click"
        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
        Background="{Binding ElementName=BtnExit, Path=Background}">
                    <ui:SymbolIcon Symbol="Add" />
                </Button>
                <Button Name="BtnWhiteBoardSwitchPrevious" FontFamily="Symbol"
        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchPrevious_Click"
        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
        Background="{Binding ElementName=BtnExit, Path=Background}"
        VerticalContentAlignment="Center"
        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="-90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Border Height="48" CornerRadius="2" Margin="3,0">
                    <TextBlock Name="TextBlockWhiteBoardIndexInfo"
                   Text="1 / 1"
                   Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                   VerticalAlignment="Center" HorizontalAlignment="Center" FontFamily="Microsoft YaHei UI" FontSize="18"/>
                </Border>
                <Button Name="BtnWhiteBoardSwitchNext" FontFamily="Symbol"
        Width="50" Height="48" FontSize="25" Click="BtnWhiteBoardSwitchNext_Click"
        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
        Background="{Binding ElementName=BtnExit, Path=Background}"
        VerticalContentAlignment="Center"
        IsEnabled="False" IsEnabledChanged="Btn_IsEnabledChanged">
                    <Image RenderTransformOrigin="0.5,0.5" Opacity="0.25">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform/>
                                <SkewTransform/>
                                <RotateTransform Angle="90"/>
                                <TranslateTransform/>
                            </TransformGroup>
                        </Image.RenderTransform>
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V64 H64 V0 H0 Z">
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="{Binding ElementName=BtnExit, Path=Foreground}" Geometry="F1 M64,64z M0,0z M32,26.41L16.566,41.844 14.439,39.717 32,22.156 49.561,39.717 47.434,41.844 32,26.41z" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>
                </Button>
                <Button Name="BtnWhiteBoardDelete" Click="BtnWhiteBoardDelete_Click"
                        FontFamily="Microsoft YaHei UI" Width="50" Height="48" FontSize="26"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False">
                    <ui:SymbolIcon Symbol="Delete" />
                </Button>
            </ui:SimpleStackPanel>
        </Grid>
        <!--// 设置界面 //-->
        <Border Name="BorderSettings" Background="White" BorderBrush="Black"
                BorderThickness="1" CornerRadius="5" ui:ThemeManager.RequestedTheme="Light"
                Width="440" HorizontalAlignment="Center" Margin="0,150,0,350" Visibility="Visible">
            <Grid>
                <ui:ScrollViewerEx Margin="0,60,0,50" VerticalScrollBarVisibility="Auto"
                              PanningMode="VerticalOnly" ui:ThemeManager.RequestedTheme="Light"
                              ManipulationBoundaryFeedback="SCManipulationBoundaryFeedback">
                    <StackPanel Margin="20,20,20,20">

                        <Border Margin="0,0,0,10" Height="100" CornerRadius="5" BorderBrush="Black" BorderThickness="1">
                            <ui:SimpleStackPanel VerticalAlignment="Center">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="15" Margin="0,0,0,10" Text="设置更改将自动保存，部分设置需要重启软件后生效"/>
                                <ui:SimpleStackPanel Spacing="5">
                                    <ui:SimpleStackPanel Spacing="5" Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Width="116" Height="45" FontFamily="Microsoft YaHei UI" Click="BtnRestart_Click">
                                            <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="0">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_arrow_clockwise_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="26"/>
                                                <Label FontSize="16" VerticalAlignment="Center" FontFamily="Microsoft YaHei UI" FontWeight="Bold">重启软件</Label>
                                            </ui:SimpleStackPanel>
                                        </Button>
                                        <Button Width="116" Height="45" FontFamily="Microsoft YaHei UI" FontWeight="Bold" Click="BtnResetToSuggestion_Click" Margin="0,0,0,0">
                                            <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="0">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_calendar_sync_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="26"/>
                                                <Label Margin="2,0,0,0" FontSize="16" VerticalAlignment="Center" FontFamily="Microsoft YaHei UI" FontWeight="Bold">重置设置</Label>
                                            </ui:SimpleStackPanel>
                                        </Button>
                                        <Button Width="116" Height="45" FontFamily="Microsoft YaHei UI" Click="BtnExit_Click">
                                            <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="0">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_power_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="26"/>
                                                <Label FontSize="16" VerticalAlignment="Center" FontFamily="Microsoft YaHei UI" FontWeight="Bold">关闭软件</Label>
                                            </ui:SimpleStackPanel>
                                        </Button>
                                    </ui:SimpleStackPanel>
                                </ui:SimpleStackPanel>
                            </ui:SimpleStackPanel>
                        </Border>
                        <GroupBox Header="启动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdate" Header="自动检查更新" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsAutoUpdate_Toggled"/>
                                <Border BorderBrush="Black" BorderThickness="1" CornerRadius="5" Padding="12">
                                    <ui:SimpleStackPanel Spacing="12">
                                        <TextBlock Text="# 开启 自动检查更新 后，将在软件启动时检查版本号，若版本号落后则会尝试从 Github 下载最新版安装包，安装新版本后会自动删除安装包。更新代理设置文本框放空即为直接裸连 Github。" TextWrapping="Wrap" Foreground="#666666"/>
                                        <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdateWithProxy" Header="代理设置" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsAutoUpdateWithProxy_Toggled"/>
                                        <TextBlock x:Name="AutoUpdateWithProxy_Title" Text="更新代理设置" FontSize="15" FontWeight="Bold" TextWrapping="Wrap" Foreground="Black"/>
                                        <TextBox x:Name="AutoUpdateProxyTextBox" Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}" Text="https://mirror.ghproxy.com/" TextWrapping="Wrap" TextChanged="AutoUpdateProxyTextBox_TextChanged" />
                                        <Grid Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                                <Button Padding="15 7.5" Content="设置代理为 GHProxy" Click="BtnResetAutoUpdateProxyToGHProxy_Click"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                                <Button Padding="15 7.5" Content="检查代理返回数据" Click="BtnCheckAutoUpdateProxyReturnedData_Click"/>
                                            </StackPanel>
                                        </Grid>
                                        <TextBlock Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}" Text='# 正确的代理返回数据应为三位版本号，例如 "4.0.0"。' TextWrapping="Wrap" Foreground="#666666"/>
                                        <TextBlock Visibility="{Binding ElementName=AutoUpdateWithProxy_Title, Path=Visibility}" Text='# 检查代理返回数据具有一定延迟，弹窗内容为空即无返回数据。' TextWrapping="Wrap" Foreground="#666666"/>
                                    </ui:SimpleStackPanel>
                                </Border>

                                <ui:ToggleSwitch Name="ToggleSwitchIsAutoUpdateWithSilence" Header="静默更新" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsAutoUpdateWithSilence_Toggled"/>
                                <Border BorderBrush="Black" BorderThickness="1" CornerRadius="5" Padding="12" Visibility="{Binding ElementName=ToggleSwitchIsAutoUpdateWithSilence, Path=Visibility}">
                                    <ui:SimpleStackPanel Spacing="12">
                                        <TextBlock Text="# 关闭静默更新后，已完成安装包的下载后将会弹窗询问是否进行更新，开启静默更新后将会在安装包下载完成后每隔十分钟进行如下检测：①处于静默更新时间段内 ②未处于书写模式 ③未处于画板内。若以上检测通过即会关闭软件进行自动更新。" TextWrapping="Wrap" Foreground="#666666"/>
                                        <ui:SimpleStackPanel x:Name="AutoUpdateTimePeriodBlock" Spacing="12">
                                            <ui:SimpleStackPanel Spacing="12">
                                                <TextBlock Text="静默更新时间段" FontSize="15" FontWeight="Bold" TextWrapping="Wrap" Foreground="Black"/>
                                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                                    <ui:SimpleStackPanel Orientation="Horizontal">
                                                        <TextBlock Margin="0,0,10,0" VerticalAlignment="Center" Text="起始时间" FontSize="14" TextWrapping="Wrap" Foreground="Black"/>
                                                        <ComboBox x:Name="AutoUpdateWithSilenceStartTimeComboBox" Width="90" SelectionChanged="AutoUpdateWithSilenceStartTimeComboBox_SelectionChanged"/>
                                                    </ui:SimpleStackPanel>
                                                    <ui:SimpleStackPanel Orientation="Horizontal">
                                                        <TextBlock Margin="0,0,10,0" VerticalAlignment="Center" Text="终止时间" FontSize="14" TextWrapping="Wrap" Foreground="Black"/>
                                                        <ComboBox x:Name="AutoUpdateWithSilenceEndTimeComboBox" Width="90" SelectionChanged="AutoUpdateWithSilenceEndTimeComboBox_SelectionChanged"/>
                                                    </ui:SimpleStackPanel>
                                                </ui:SimpleStackPanel>
                                                <TextBlock Width="340" HorizontalAlignment="Left" Text="# 若终止时间小于起始时间，即将终止时间视为第二天的时间。# 若起始时间与终止时间相同，即视为全天候时间。" TextWrapping="Wrap" Foreground="#666666"/>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </ui:SimpleStackPanel>
                                </Border>

                                <ui:ToggleSwitch Name="ToggleSwitchRunAtStartup" Header="开机时运行" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchRunAtStartup_Toggled"/>

                                <ui:ToggleSwitch Name="ToggleSwitchFoldAtStartup" Header="开机运行后收纳到侧边栏" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchFoldAtStartup_Toggled"/>
                                <!--
                                <ui:ToggleSwitch Name="ToggleSwitchAutoHideCanvas" Header="自动隐藏画板" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoHideCanvas_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoEnterModeFinger" Header="自动进入手指模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoEnterModeFinger_Toggled"/>
                                -->
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="画板">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchShowCursor" Header="显示画笔光标" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCursor_Toggled"/>
                                <!--
                                <TextBlock Text="画笔样式" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                    <ComboBoxItem Content="模拟笔锋（根据墨迹尾部计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="模拟笔锋（根据速度计算）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="无笔锋"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <ui:ToggleSwitch x:Name="ToggleSwitchModeFinger" Header="手指模式" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                                
                                <TextBlock Text="# 此选项仅适用于可获取触摸面积的屏幕" TextWrapping="Wrap" Foreground="#666666"/>
                                
                                <TextBlock Text="橡皮模式"  FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxEraserType" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxEraserType_OnSelectionChanged">
                                    <ComboBoxItem Content="交替切换" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="面积擦" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="笔画擦" FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                -->
                                <TextBlock Text="橡皮大小"  FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxEraserSize" FontFamily="Microsoft YaHei UI" SelectedIndex="2" SelectionChanged="ComboBoxEraserSize_SelectionChanged">
                                    <ComboBoxItem Content="小" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="较小" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="中（默认）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="较大"  FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="大"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <ui:ToggleSwitch Name="ToggleSwitchHideStrokeWhenSelecting" Header="退出画板模式后隐藏墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchHideStrokeWhenSelecting_Toggled"/>
                                <TextBlock Text="# 开启 退出画板模式后隐藏墨迹 选项后，进入 PPT 模式时未处于批注模式时不会显示墨迹。" TextWrapping="Wrap" Foreground="#666666"/>
                                <!--
                                <ui:ToggleSwitch Name="ToggleSwitchUsingWhiteboard" Header="使用白板 (白色背景)" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchUsingWhiteboard_Toggled"/>
                                -->
                                <TextBlock Text="保留双曲线渐近线" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxHyperbolaAsymptoteOption" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxHyperbolaAsymptoteOption_SelectionChanged">
                                    <ComboBoxItem Content="是" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="否" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="每次询问" FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                <TextBlock Text="# 请注意，若不保留双曲线渐近线可能会有遇到撤回相关的 BUG 影响用。" TextWrapping="Wrap" Foreground="#666666"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="手势">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSwitchTwoFingerGesture" Header="自动开关两指缩放功能" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSwitchTwoFingerGesture_Toggled"/>
                                <TextBlock Text="# 开启 自动开关两指缩放功能 后退出画板模式时自动关闭双指移动手势，进入画板模式时自动开启双指移动手势" TextWrapping="Wrap" Foreground="#666666"/>

                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerRotationOnSelection" Header="允许双指旋转选中的墨迹" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                                <TextBlock Text="# 允许选中墨迹后对墨迹进行双指或多指缩放操作（此设置不受“允许双指旋转”设置的影响）" TextWrapping="Wrap" Foreground="#666666"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxInkRecognition" Header="墨迹识别">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="# 可实现智能识别圆、三角形、矩形，并自动转换为规范图形。" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableInkToShape" Header="启用墨迹识别" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableInkToShape_Toggled" IsOn="True"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Name="GroupBoxAppearanceNewUI" Header="外观">
                            <ui:SimpleStackPanel Spacing="12">
                                <!--
                                <ui:ToggleSwitch Header="显示“橡皮”按钮" IsOn="{Binding ElementName=ToggleSwitchShowButtonEraser, Path=IsOn}" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关"/>
                                -->
                                <ui:ToggleSwitch Name="ToggleSwitchEnableDisPlayNibModeToggle" Header="在调色盘窗口中显示 笔尖模式 按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableDisPlayNibModeToggle_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchColorfulViewboxFloatingBar" Header="浮动工具栏背景色" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsColorfulViewboxFloatingBar_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableViewboxFloatingBarScaleTransform" Header="浮动工具栏 UI 85% 缩放" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableViewboxFloatingBarScaleTransform_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableViewboxBlackBoardScaleTransform" Header="画板 UI 80% 缩放" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableViewboxBlackBoardScaleTransform_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowButtonPPTNavigation" Header="显示 PPT 浏览切页按钮（页码按钮）" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowButtonPPTNavigation_OnToggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowBottomPPTNavigationPanel" Header="显示 PPT 下方翻页控制按钮" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowBottomPPTNavigationPanel_OnToggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowSidePPTNavigationPanel" Header="显示 PPT 侧边翻页控制按钮" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowSidePPTNavigationPanel_OnToggled"/>
                                <!--
                                <TextBlock Text="颜色主题" FontFamily="Microsoft YaHei UI" FontSize="14"/>
                                <ComboBox Name="ComboBoxTheme" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxTheme_SelectionChanged">
                                    <ComboBoxItem Content="浅色（默认）" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="深色" FontFamily="Microsoft YaHei UI"/>
                                    <ComboBoxItem Content="跟随系统"  FontFamily="Microsoft YaHei UI"/>
                                </ComboBox>
                                -->
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="PowerPoint 相关">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="# 此部分的设置项将会在幻灯片播放时使用，优先级高于其他设置项" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportPowerPoint" Header="Microsoft PowerPoint 支持" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportPowerPoint_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSupportWPS" Header="WPS Office 支持" IsOn="True" IsEnabled="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSupportWPS_Toggled"/>
                                <TextBlock Text="# 不推荐使用 WPS Office，鉴于其对于触摸设备的较差支持及其自身的兼容性问题，对 WPS Office 支持时会导致 WPS Office 关闭时卡顿。" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowCanvasAtNewSlideShow" Header="进入 PPT 放映时自动进入批注模式" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowCanvasAtNewSlideShow_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableTwoFingerGestureInPresentationMode" Header="允许幻灯片模式下的双指手势" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchEnableTwoFingerGestureInPresentationMode_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchEnableFingerGestureSlideShowControl" Header="允许使用手指手势进行幻灯片翻页" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="False" Toggled="ToggleSwitchEnableFingerGestureSlideShowControl_Toggled"/>
                                <TextBlock Text="# 允许开启画板时使用手指手势进行幻灯片翻页（启用后，在幻灯片放映模式下，当画板无墨迹时，使用手指（笔尖或手掌无法识别）左右滑动即可控制幻灯片翻页。）" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveScreenShotInPowerPoint" Header="自动幻灯片截屏" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveScreenShotInPowerPoint_Toggled"/>
                                <TextBlock Text="#开启 自动幻灯片截屏 后将会在幻灯片有墨迹时翻页自动截屏" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesInPowerPoint" Header="自动保存幻灯片墨迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesInPowerPoint_Toggled"/>
                                <TextBlock Text="#开启 自动保存幻灯片墨迹 后将在结束幻灯片放映时自动将保存已有墨迹，并在下次打开时自动加载（文件名和幻灯片页数都要相同）" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyPreviousPage" Header="记忆并提示上次播放位置" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyPreviousPage_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchNotifyHiddenPage" Header="提示隐藏幻灯片" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNotifyHiddenPage_Toggled"/>
                                <!--
                                <ui:ToggleSwitch Name="ToggleSwitchNoStrokeClearInPowerPoint" Header="退出画板模式时不清除笔迹" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchNoStrokeClearInPowerPoint_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchShowStrokeOnSelectInPowerPoint" Header="退出画板模式时不隐藏笔迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchShowStrokeOnSelectInPowerPoint_Toggled"/>
                                -->
                            </ui:SimpleStackPanel>

                        </GroupBox>
                        <GroupBox Header="高级">
                            <ui:SimpleStackPanel Spacing="12">
                                <TextBlock Text="#可在手指触摸画板时显示圆形橡皮或手掌触摸画板时显示的橡皮比&#x000A;手掌大很多时调整" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsSpecialScreen" Header="特殊屏幕模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsSpecialScreen_OnToggled"/>
                                <StackPanel Orientation="Horizontal" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="TouchMultiplierSlider"
                                            Minimum="0" Maximum="2"
                                            Width="340" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="触摸大小倍数"
                                            IsSnapToTickEnabled="True"
                                            TickFrequency="0.01" TickPlacement="None"
                                            ValueChanged="TouchMultiplierSlider_ValueChanged"
                                            Visibility="Visible"/>
                                    <TextBlock Text="{Binding Value, ElementName=TouchMultiplierSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8"
                                               FontSize="14" Width="30" HorizontalAlignment="Center"
                                               Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}"/>
                                </StackPanel>

                                <ui:SimpleStackPanel Spacing="8" Margin="0,4,0,4" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <TextBlock FontSize="14" Text="在下方区域内用笔尖点击以估计触摸大小倍数"/>
                                    <TextBlock Text="# 数值仅供参考" Foreground="#666666"/>
                                    <Border Margin="0,0,20,0" CornerRadius="4" Height="48" Background="White" BorderBrush="Black" BorderThickness="2" TouchDown="BorderCalculateMultiplier_TouchDown"/>
                                    <TextBlock Name="TextBlockShowCalculatedMultiplier" FontSize="14"/>
                                </ui:SimpleStackPanel>

                                <ui:ToggleSwitch Name="ToggleSwitchEraserBindTouchMultiplier" Header="橡皮擦绑定触摸大小倍数" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="False" Toggled="ToggleSwitchEraserBindTouchMultiplier_Toggled" Visibility="{Binding Path=Visibility, ElementName=TouchMultiplierSlider, Mode=OneWay}"/>


                                <TextBlock Text="# BoundsWidth 参数作为接触面积区分界限，用来区分橡皮和书写模式。笔尖模式参数值应较小。" TextWrapping="Wrap" Foreground="#666666"/>
                                <StackPanel Orientation="Horizontal" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="NibModeBoundsWidthSlider" Minimum="1" Maximum="50" Width="340" FontFamily="Microsoft YaHei UI" ui:ControlHelper.Header="笔尖模式 BoundsWidth"
                                            FontSize="15" IsSnapToTickEnabled="True" TickFrequency="1" Value="5" TickPlacement="None" ValueChanged="NibModeBoundsWidthSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=NibModeBoundsWidthSlider, Mode=OneWay}"
                                            VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14" Width="30"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Visibility="{Binding Visibility,ElementName=TouchMultiplierSlider}">
                                    <Slider x:Name="FingerModeBoundsWidthSlider" Minimum="1" Maximum="50" Width="340" FontFamily="Microsoft YaHei UI" ui:ControlHelper.Header="手指模式 BoundsWidth"
                                            FontSize="15" IsSnapToTickEnabled="True" TickFrequency="1" Value="20" TickPlacement="None" ValueChanged="FingerModeBoundsWidthSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=FingerModeBoundsWidthSlider, Mode=OneWay}"
                                               VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14" Width="30"/>
                                </StackPanel>

                                <ui:ToggleSwitch Name="ToggleSwitchIsQuadIR" Header="四边红外模式" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchIsQuadIR_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsLogEnabled" Header="记录日志" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="True" Toggled="ToggleSwitchIsLogEnabled_Toggled"/>
                                <TextBlock Text="# 日志文件超过 512 KB 时会自动删除。" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchIsSecondConfimeWhenShutdownApp" Header="关闭软件时二次弹窗确认" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" IsOn="False" Toggled="ToggleSwitchIsSecondConfimeWhenShutdownApp_Toggled"/>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="自动">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNote" Header="进入“希沃白板”时自动收纳至侧边栏" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInEasiNote_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNoteIgnoreDesktopAnno" Header="“希沃白板”自动收纳忽略桌面 EN 批注窗口 (BETA)" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInEasiNoteIgnoreDesktopAnno_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiCamera" Header="进入“希沃视频展台”时自动收纳至侧边栏" IsOn="True" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInEasiCamera_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInEasiNote3C" Header="进入“希沃轻白板”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInEasiNote3C_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInSeewoPincoTeacher" Header="进入“希沃品课”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInSeewoPincoTeacher_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInHiteTouchPro" Header="进入“鸿合白板”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInHiteTouchPro_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInHiteCamera" Header="进入“鸿合视频展台”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInHiteCamera_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInWxBoardMain" Header="进入“文香白板”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInWxBoardMain_Toggled"/>
                                <!--<ui:ToggleSwitch Name="ToggleSwitchAutoFoldInZySmartBoard" Header="进入“中原新白板（相似鸿合）”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInZySmartBoard_Toggled"/>-->
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInOldZyBoard" Header="进入“中原旧白板”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInOldZyBoard_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInMSWhiteboard" Header="进入“微软 Whiteboard”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInMSWhiteboard_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoFoldInPPTSlideShow" Header="进入“PPT 放映”时自动收纳至侧边栏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoFoldInPPTSlideShow_Toggled"/>
                                <TextBlock Text="# 请注意，查杀 PPT 小工具会导致希沃课堂授课助手无法使用，直接进入希沃课堂授课助手安装目录删除 Office.dll 文件即可进入 PPT 放映时不会启动希沃的 PPT 工具栏。" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillPptService" Header="自动查杀“PPT 小工具”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillPptService_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoKillEasiNote" Header="自动查杀“希沃白板 5”" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoKillEasiNote_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtClear" Header="清屏时自动截图" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtClear_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchSaveScreenshotsInDateFolders" Header="截图分日期文件夹保存" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchSaveScreenshotsInDateFolders_Toggled"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoSaveStrokesAtScreenshot" Header="截图时自动保存墨迹" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoSaveStrokesAtScreenshot_Toggled"/>
                                <!--
                                <ui:ToggleSwitch Name="ToggleSwitchClearExitingWritingMode" Header="切换到鼠标模式后自动清屏" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchExitingWritingMode_Toggled"/>
                                -->
                                <StackPanel Orientation="Horizontal">
                                    <Slider x:Name="SideControlMinimumAutomationSlider"
                                            HorizontalAlignment="Left"
                                            Minimum="0" Maximum="10"
                                            Width="335" FontFamily="Microsoft YaHei UI" 
                                            ui:ControlHelper.Header="自动截图最小墨迹量(数值为 0 即有墨迹时会自动截图)"
                                            IsSnapToTickEnabled="True" Value="0"
                                            TickFrequency="1" TickPlacement="None"
                                            ValueChanged="SideControlMinimumAutomationSlider_ValueChanged"/>
                                    <TextBlock Text="{Binding Value, ElementName=SideControlMinimumAutomationSlider, Mode=OneWay}"
                                           VerticalAlignment="Bottom" Margin="10,0,0,8"
                                           FontSize="14" Width="25" HorizontalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock FontSize="15">墨迹、截图自动保存位置:</TextBlock>
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="10">
                                    <TextBox Width="320" x:Name="AutoSavedStrokesLocation" Text="D:\Ink Canvas" TextWrapping="Wrap" TextChanged="AutoSavedStrokesLocationTextBox_TextChanged" />
                                    <Button Name="AutoSavedStrokesLocationButton" Grid.Row="1" Content="浏览" Click="AutoSavedStrokesLocationButton_Click"/>
                                </ui:SimpleStackPanel>
                                <ui:SimpleStackPanel Orientation="Horizontal" Spacing="12">
                                    <Button Name="SetAutoSavedStrokesLocationToDiskDButton" Grid.Row="1" Content="设置保存到 D:\Ink Canvas" Click="SetAutoSavedStrokesLocationToDiskDButton_Click"/>
                                    <Button Name="SetAutoSavedStrokesLocationToDocumentFolderButton" Grid.Row="1" Content="设置保存到 文档" Click="SetAutoSavedStrokesLocationToDocumentFolderButton_Click"/>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="* 请注意检查保存文件夹是否有写入权限" TextWrapping="Wrap" Foreground="#666666"/>
                                <ui:ToggleSwitch Name="ToggleSwitchAutoDelSavedFiles" Header="定期自动删除超过保存时间的墨迹、截图文件" IsOn="False" FontFamily="Microsoft YaHei UI" OnContent="开" OffContent="关" Toggled="ToggleSwitchAutoDelSavedFiles_Toggled"/>
                                <TextBlock Text="！请注意自动删除功能将会删除自动保存目录下所有后缀名为 .icstk 和 .png 的文件！" TextWrapping="Wrap" Foreground="Black"/>
                                <TextBlock FontSize="15">保存时间设置（Days）:</TextBlock>
                                <ComboBox Name="ComboBoxAutoDelSavedFilesDaysThreshold" FontFamily="Microsoft YaHei UI" SelectedIndex="4" SelectionChanged="ComboBoxAutoDelSavedFilesDaysThreshold_SelectionChanged">
                                    <ComboBoxItem Content="1"/>
                                    <ComboBoxItem Content="3"/>
                                    <ComboBoxItem Content="5"/>
                                    <ComboBoxItem Content="7"/>
                                    <ComboBoxItem Content="15"/>
                                    <ComboBoxItem Content="30"/>
                                    <ComboBoxItem Content="60"/>
                                    <ComboBoxItem Content="100"/>
                                    <ComboBoxItem Content="365"/>
                                </ComboBox>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                        <GroupBox Header="关于">
                            <ui:SimpleStackPanel Spacing="12">
                                <ui:SimpleStackPanel Orientation="Horizontal">
                                    <TextBlock FontSize="18" FontWeight="Bold" Text="当前版本："/>
                                    <TextBlock x:Name="AppVersionTextBlock" FontSize="18" FontWeight="Bold" Text="4.X.X.X"/>
                                </ui:SimpleStackPanel>
                                <TextBlock Text="* 使用和分发本软件前，请您应当且务必知晓相关开源协议，且您应当知晓本软件基于 https://github.com/WXRIW/Ink-Canvas 修改而成。" TextWrapping="Wrap" Foreground="#666666"/>
                                <Border BorderBrush="DarkBlue" BorderThickness="2" CornerRadius="5" Padding="0,5">
                                    <WrapPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal">
                                        <TextBlock Text="开源协议: " FontSize="15" FontWeight="Bold"/>
                                        <Image Source="/Resources/Icons-Fluent/ic_fluent_scales_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20"/>
                                        <TextBlock Text="GNU General Public License v3.0" FontSize="15"/>
                                    </WrapPanel>
                                </Border>
                                <TextBlock FontSize="15">
                                    <Bold>本项目仓库源:</Bold>
                                    <Hyperlink Click="HyperlinkSourceToPresentRepository_Click">
                                        <TextBlock Margin="2,0" Width="250" Text="https://github.com/ChangSakura/Ink-Canvas" TextWrapping="Wrap"/>
                                    </Hyperlink>
                                </TextBlock>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="本项目开发者: " FontSize="15" FontWeight="Bold"/>
                                    <Image Source="/Resources/DeveloperAvatars/ChangSakura.png" RenderOptions.BitmapScalingMode="HighQuality" Width="20" Height="20"/>
                                    <TextBlock Text="CJ Wu (ChangSakura)" FontSize="15"/>
                                </WrapPanel>

                                <Line HorizontalAlignment="Center" X1="0" Y1="0" X2="350" Y2="0" Stroke="Black" StrokeThickness="2"/>

                                <TextBlock FontSize="15">
                                    <Bold>原项目仓库源:</Bold>
                                    <Hyperlink Click="HyperlinkSourceToOringinalRepository_Click">
                                        <TextBlock Margin="2,0" Text="https://github.com/WXRIW/Ink-Canvas"></TextBlock>
                                    </Hyperlink>
                                </TextBlock>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="原项目开发者: " FontSize="15" FontWeight="Bold"/>
                                    <Image Source="/Resources/DeveloperAvatars/WXRIW.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                        <Image.Clip>
                                            <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                        </Image.Clip>
                                    </Image>
                                    <TextBlock Text="XY Wang (WXRIW)" FontSize="15"/>
                                </WrapPanel>
                                <WrapPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <TextBlock Text="原项目贡献者: " FontSize="15" FontWeight="Bold" Margin="0,0,0,5"/>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/Kengwang.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Kengwang" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/Raspberry-Monster.jpg" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Raspberry Kan " FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/jiajiaxd.jpg" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="jiajiaxd" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/CN-Ironegg.jpg" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="CN-Ironegg" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/clover-yan.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="Clover Yan" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/STBBRD.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="STBBRD" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                    <ui:SimpleStackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                        <Image Source="/Resources/DeveloperAvatars/ChangSakura.png" RenderOptions.BitmapScalingMode="HighQuality" Margin="3,0" Width="20" Height="20">
                                            <Image.Clip>
                                                <EllipseGeometry Center="10,10" RadiusX="10" RadiusY="10" />
                                            </Image.Clip>
                                        </Image>
                                        <TextBlock Text="ChangSakura" FontSize="15"/>
                                    </ui:SimpleStackPanel>
                                </WrapPanel>
                            </ui:SimpleStackPanel>
                        </GroupBox>
                    </StackPanel>
                </ui:ScrollViewerEx>
                <Grid Background="White" Margin="20" Height="40" VerticalAlignment="Top">
                    <ui:SimpleStackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="/Resources/Icons-Fluent/ic_fluent_settings_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="30" Width="30">
                            <Image.RenderTransform>
                                <RotateTransform Angle="0" CenterX="15" CenterY="15" />
                            </Image.RenderTransform>
                            <Image.Triggers>
                                <EventTrigger RoutedEvent="Loaded">
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)" From="0" To="360" Duration="0:0:2" RepeatBehavior="Forever" />
                                        </Storyboard>
                                    </BeginStoryboard>
                                </EventTrigger>
                            </Image.Triggers>
                        </Image>
                        <TextBlock Margin="10,-2,0,0" Text="详细设置" FontSize="26"/>
                    </ui:SimpleStackPanel>
                </Grid>
                <Grid VerticalAlignment="Bottom" Height="50">
                    <Button FontFamily="Microsoft YaHei UI"
                            Width="120" Margin="10"
                            HorizontalAlignment="Right"
                            Content="关闭"
                            Click="BtnSettings_Click"/>
                </Grid>
            </Grid>
        </Border>

        <!-- 通知弹窗 -->
        <Grid Name="GridNotifications" Margin="0,110" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Bottom">
            <Border CornerRadius="10" MaxHeight="200" Padding="20 10" Background="White" Opacity="0.95" BorderBrush="Black" BorderThickness="1.5">
                <TextBlock Name="TextBlockNotice" Text="测试文本" VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="16"/>
            </Border>
        </Grid>
        <!--// Old UI //-->
        <Viewbox Name="ViewBoxStackPanelMain" Visibility="Visible" Margin="10,10,10,55" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="46">
            <StackPanel Name="StackPanelMain" Width="46">
                <StackPanel Name="StackPanelControl">
                    <Button Name="BtnExit" Content="退出" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnExit_Click" Background="#7F909090"/>

                    <Button Name="BtnThickness" Content="粗细" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnThickness_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>

                    <Button Name="BtnSwitchTheme" Content="深色" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <!-- Click="BtnSwitchTheme_Click" -->

                    <Button Name="BtnSwitch" Content="背景" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnSwitch_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnHideInkCanvas" Content="隐藏&#x000A;画板" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnHideInkCanvas_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <Button x:Name="BtnCheckPPT" Visibility="Collapsed" Content="检查" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnCheckPPT_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    <StackPanel Name="StackPanelPPTButtons">
                        <Button x:Name="BtnPPTSlideShow" Visibility="Collapsed" Content="从头&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShow_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button x:Name="BtnPPTSlideShowEnd" Visibility="Collapsed" Content="结束&#x000A;放映" FontFamily="Microsoft YaHei UI"
                                Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                Click="BtnPPTSlideShowEnd_Click"  Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <StackPanel Name="StackPanelPPTControls" Visibility="Collapsed">
                            <Button x:Name="BtnPPTSlidesUp" Content="↑" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                            <Button x:Name="BtnPPTSlidesDown" Content="↓" FontFamily="Microsoft YaHei UI"
                                    Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                                    Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        </StackPanel>
                    </StackPanel>
                    <Button x:Name="BtnSwitchSide" Content="⇆" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnSwitchSide_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                </StackPanel>
                <Button x:Name="BtnHideControl" Content="⇅" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnHideControl_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
            </StackPanel>
        </Viewbox>
        <Viewbox Name="ViewBoxStackPanelShapes" Margin="{Binding ElementName=ViewBoxStackPanelMain, Path=Margin}" Width="46" HorizontalAlignment="Left" VerticalAlignment="Bottom" Visibility="Visible">
            <StackPanel Name="StackPanelShapes" Width="46">
                <Button Name="BtnFingerDragMode" Content="单指&#x000A;拖动" Visibility="Visible" FontFamily="Microsoft YaHei UI"
                        Margin="0,25,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnFingerDragMode_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <StackPanel IsVisibleChanged="StackPanel_IsVisibleChanged" Visibility="{Binding ElementName=StackPanelPPTButtons, Path=Visibility}">
                    <StackPanel Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                        <Button Content="↑" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesUp_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                        <Button Content="↓" FontFamily="Microsoft YaHei UI"
                            Margin="0,10,0,15" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                            Click="BtnPPTSlidesDown_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                    </StackPanel>
                </StackPanel>
                <Button x:Name="BtnUndo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnUndo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Undo"/>
                        <TextBlock Text="撤销" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button x:Name="BtnRedo" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}"
                        Click="BtnRedo_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}"
                        Background="{Binding ElementName=BtnExit, Path=Background}"
                        IsEnabled="False" Visibility="Collapsed" IsEnabledChanged="Btn_IsEnabledChanged">
                    <StackPanel Opacity="0.2">
                        <ui:SymbolIcon Symbol="Redo"/>
                        <TextBlock Text="恢复" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button Name="BtnClearAndHideCanvas" Content="清屏&#x000A;&amp;&#x000A;隐藏" Visibility="Collapsed" FontFamily="Microsoft YaHei UI"
                        Margin="0,10,0,0" Width="{Binding ElementName=StackPanelMain, Path=ActualWidth}" Block.TextAlignment="Center"
                        Click="BtnSelect_Click" Foreground="{Binding ElementName=BtnExit, Path=Foreground}" Background="{Binding ElementName=BtnExit, Path=Background}"/>
                <Grid Name="GridForLeftSideReservedSpace" Height="{Binding ElementName=StackPanelInfo, Path=ActualHeight}"/>
            </StackPanel>
        </Viewbox>

        <!--// PPT 工具栏 //-->
        <Grid Name="GridForRecoverOldUI">
            <Grid Visibility="{Binding ElementName=StackPanelPPTControls, Path=Visibility}">
                <Viewbox Name="BottomViewboxPPTSidesControl" Visibility="Visible" Opacity="0.5" Margin="5" Height="40" HorizontalAlignment="Left" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="3.5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" MouseDown="Border_MouseDown" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlPreviousPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border x:Name="PptNavigationBtn" Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click" MouseDown="Border_MouseDown">
                                <TextBlock Name="PptNavigationTextBlock" FontSize="9" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Center" VerticalAlignment="Center" Text="0/0" />
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Name="ImagePPTControlNextPressed" Visibility="Collapsed" Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideSelected}"/>
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
                <Viewbox Visibility="{Binding ElementName=BottomViewboxPPTSidesControl, Path=Visibility}" Opacity="0.5" Margin="5" Height="40" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                    <ui:SimpleStackPanel Orientation="Horizontal" Spacing="3.5">
                        <Border Width="36" MouseUp="GridPPTControlPrevious_MouseUp" MouseDown="Border_MouseDown" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalPreviousSlideNormal}"/>
                            </Grid>
                        </Border>
                        <Border Width="36" Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid MouseUp="PPTNavigationBtn_Click">
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" MouseDown="Border_MouseDown" Foreground="{Binding ElementName=PptNavigationTextBlock, Path=Foreground}" FontSize="{Binding ElementName=PptNavigationTextBlock, Path=FontSize}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}" />
                            </Grid>
                        </Border>
                        <Border Width="36" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                            <Grid Margin="6">
                                <Image Source="{DynamicResource ResourceKey=SeewoImageSource.HorizontalNextSlideNormal}"/>
                            </Grid>
                        </Border>
                    </ui:SimpleStackPanel>
                </Viewbox>
            </Grid>
        </Grid>

        <!--// PPT 侧边翻页按钮 //-->
        <Viewbox x:Name="LeftSidePanelForPPTNavigation" Visibility="Visible" Margin="6,0,0,0" Width="40" HorizontalAlignment="Left" VerticalAlignment="Center">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}" Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ui:SimpleStackPanel Orientation="Vertical">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp" MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <Image Height="26" Width="26" Source="/Resources/Icons-png/up.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Border>
                    <Border Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" MouseUp="PPTNavigationBtn_Click" MouseDown="Border_MouseDown" Width="40" Height="38" Background="Transparent">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="1"/>
                            </Grid.RowDefinitions>
                            <Line Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0" X2="25" Y2="0" Stroke="Black" StrokeThickness="1"/>
                            <TextBlock Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="9" Foreground="{DynamicResource FloatBarForeground}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}"/>
                            <Line Grid.Row="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0" X2="25" Y2="0" Stroke="Black" StrokeThickness="1"/>
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown" CornerRadius="0 0 5 5" Background="Transparent">
                        <Image Height="26" Width="26" Source="/Resources/Icons-png/down.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Border>
                </ui:SimpleStackPanel>
            </Border>
        </Viewbox>
        <Viewbox x:Name="RightSidePanelForPPTNavigation" Visibility="Visible" Margin="0,0,6,0" Width="40" HorizontalAlignment="Right" VerticalAlignment="Center">
            <Border BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}" Background="{DynamicResource FloatBarBackground}" Opacity="0.4" CornerRadius="6">
                <ui:SimpleStackPanel Orientation="Vertical">
                    <Border Width="40" Height="40" MouseUp="GridPPTControlPrevious_MouseUp" MouseDown="Border_MouseDown" CornerRadius="5 5 0 0" Background="Transparent">
                        <Image Height="26" Width="26" Source="/Resources/Icons-png/up.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Border>
                    <Border Visibility="{Binding ElementName=PptNavigationBtn, Path=Visibility}" MouseUp="PPTNavigationBtn_Click" MouseDown="Border_MouseDown" Width="40" Height="38" Background="Transparent">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="1"/>
                                <RowDefinition Height="36"/>
                                <RowDefinition Height="1"/>
                            </Grid.RowDefinitions>
                            <Line Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0" X2="25" Y2="0" Stroke="Black" StrokeThickness="1"/>
                            <TextBlock Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="9" Foreground="{DynamicResource FloatBarForeground}" Text="{Binding ElementName=PptNavigationTextBlock, Path=Text}"/>
                            <Line Grid.Row="2" HorizontalAlignment="Center" VerticalAlignment="Center" X1="0" Y1="0" X2="25" Y2="0" Stroke="Black" StrokeThickness="1"/>
                        </Grid>
                    </Border>
                    <Border Width="40" Height="40" MouseUp="GridPPTControlNext_MouseUp" MouseDown="Border_MouseDown" CornerRadius="0 0 5 5" Background="Transparent">
                        <Image Height="26" Width="26" Source="/Resources/Icons-png/down.png" RenderOptions.BitmapScalingMode="HighQuality"/>
                    </Border>
                </ui:SimpleStackPanel>
            </Border>
        </Viewbox>

        <Viewbox Name="ViewboxFloatingBar" Margin="100,10,-2000,-200" 
                 HorizontalAlignment="Left" Height="50" VerticalAlignment="Top">
            <Viewbox.LayoutTransform>
                <ScaleTransform x:Name="ViewboxFloatingBarScaleTransform" ScaleX="1" ScaleY="1"/>
            </Viewbox.LayoutTransform>
            <ui:SimpleStackPanel Orientation="Horizontal">
                <Border x:Name="BorderFloatingBarMoveControls" Width="36" Height="36" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                        MouseDown="SymbolIconEmoji_MouseDown" MouseUp="SymbolIconEmoji_MouseUp">
                    <ui:SimpleStackPanel Margin="0,5,0,5" Orientation="Horizontal"
                                         HorizontalAlignment="Center">
                        <ui:SymbolIcon Name="SymbolIconEmoji" Symbol="Emoji2" Foreground="{DynamicResource FloatBarForeground}"/>
                    </ui:SimpleStackPanel>
                </Border>
                <Border Padding="2" Margin="2,0,0,0" Visibility="Visible" Height="36" Name="BorderFloatingBarMainControls" Background="{DynamicResource FloatBarBackground}" CornerRadius="5" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                    <ui:SimpleStackPanel Margin="2,0" Name="StackPanelFloatingBar" Orientation="Horizontal">
                        <ui:SimpleStackPanel Name="Cursor_Icon" MouseDown="Border_MouseDown" MouseUp="CursorIcon_Click"
                                             Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center" Width="28">
                            <Image Source="/Resources/Icons-Fluent/ic_fluent_cursor_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>

                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="Pen_Icon" MouseDown="Border_MouseDown" MouseUp="PenIcon_Click"
                                             Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center" Width="28">
                            <Image x:Name="PenIcon" Source="/Resources/Icons-Fluent/ic_fluent_signature_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>

                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="SymbolIconDelete" MouseDown="Border_MouseDown" MouseUp="SymbolIconDelete_MouseUp"
                                             Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center" Width="28">
                            <Image Source="/Resources/Icons-Fluent/ic_fluent_delete_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Name="StackPanelCanvasControls" Visibility="Visible" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <ui:SimpleStackPanel Width="0" Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                                <Grid Margin="0,5,0,5" Width="0" RenderTransformOrigin="0.5,0.5">
                                    <Border x:Name="PenPalette" Visibility="Visible" Background="white" Opacity="0.9" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1" CornerRadius="8" Margin="-160,-190,-70,35">

                                        <Viewbox>
                                            <StackPanel Margin="20 10">
                                                <Viewbox HorizontalAlignment="Center" VerticalAlignment="Center">
                                                    <ui:SimpleStackPanel>
                                                        <Controls:UniformGrid Columns="2" Width="300" Height="55">
                                                            <ui:SimpleStackPanel Orientation="Horizontal" Height="35">
                                                                <Label Content="笔锋" Margin="0,0,12,0" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                                <ComboBox Height="30" VerticalAlignment="Center" Name="ComboBoxPenStyle" FontFamily="Microsoft YaHei UI" SelectedIndex="0" SelectionChanged="ComboBoxPenStyle_SelectionChanged">
                                                                    <ComboBoxItem Content="抬笔笔锋" FontFamily="Microsoft YaHei UI"/>
                                                                    <ComboBoxItem Content="速度笔锋" FontFamily="Microsoft YaHei UI"/>
                                                                    <ComboBoxItem Content="关闭笔锋" FontFamily="Microsoft YaHei UI"/>
                                                                </ComboBox>
                                                            </ui:SimpleStackPanel>
                                                            <ui:SimpleStackPanel Margin="0,-5,0,-5" VerticalAlignment="Center">
                                                                <ui:SimpleStackPanel x:Name="NibModeSimpleStackPanel" Orientation="Horizontal" Width="140">
                                                                    <Label Content="笔尖模式" FontSize="15" VerticalAlignment="Center"/>
                                                                    <ui:ToggleSwitch x:Name="ToggleSwitchEnableNibMode" MinWidth="0" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关" Margin="10,0,0,0" Toggled="ToggleSwitchEnableNibMode_Toggled" IsOn="True"/>
                                                                </ui:SimpleStackPanel>
                                                                <ui:SimpleStackPanel Orientation="Horizontal" Width="140">
                                                                    <Label Margin="0,0,10,0" Content="墨迹识别" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                                    <ui:ToggleSwitch Foreground="{DynamicResource FloatBarForeground}" FontFamily="Microsoft YaHei UI" Width="70" OnContent="开" OffContent="关"
                                                                                     Toggled="ToggleSwitchEnableInkToShape_Toggled" MinWidth="0" IsOn="{Binding ElementName=ToggleSwitchEnableInkToShape, Path=IsOn}"/>
                                                                </ui:SimpleStackPanel>
                                                            </ui:SimpleStackPanel>
                                                        </Controls:UniformGrid>


                                                        <StackPanel Orientation="Horizontal" Height="30">
                                                            <Label Margin="0,0,10,0" Content="粗细" Foreground="{DynamicResource FloatBarForeground}" FontSize="15" VerticalAlignment="Center"/>
                                                            <Slider x:Name="InkWidthSlider" Minimum="1" Maximum="15" Width="230" FontFamily="Microsoft YaHei UI"
                                                                    FontSize="20" IsSnapToTickEnabled="True" Value="5" TickFrequency="1" TickPlacement="None" ValueChanged="InkWidthSlider_ValueChanged"/>
                                                            <TextBlock Text="{Binding Value, ElementName=InkWidthSlider, Mode=OneWay}" VerticalAlignment="Bottom" Margin="10,0,0,8" FontSize="14"/>
                                                        </StackPanel>
                                                    </ui:SimpleStackPanel>
                                                </Viewbox>
                                                <ui:SimpleStackPanel Width="300">
                                                    <!--<TextBlock FontSize="25">画笔颜色</TextBlock>-->
                                                    <Border Width="300" Height="130" BorderBrush="Black" BorderThickness="0" CornerRadius="5">
                                                        <Controls:UniformGrid Rows="2" Height="130">
                                                            <ui:SimpleStackPanel Height="55" Orientation="Horizontal" Width="270">
                                                                <Controls:UniformGrid Columns="4" Width="270">
                                                                    <Border BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseDown="Border_MouseDown" MouseUp="ColorThemeSwitch_MouseUp">
                                                                        <Grid Margin="5">
                                                                            <Image x:Name="ColorThemeSwitchIcon" Source="/Resources/Icons-Fluent/ic_fluent_weather_sunny_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" VerticalAlignment="Top" Width="26" Height="26"/>
                                                                            <TextBlock x:Name="ColorThemeSwitchTextBlock" Text="亮系" Foreground="Black" VerticalAlignment="Bottom" HorizontalAlignment="Center" FontSize="13"/>
                                                                        </Grid>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorBlack" Background="Black" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorBlack_Click">
                                                                        <Viewbox Name="ViewboxBtnColorBlackContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorWhite" Background="White" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorWhite_Click">
                                                                        <Viewbox x:Name="ViewboxBtnColorWhiteContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="Black"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorRed" Background="red" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorRed_Click">
                                                                        <Viewbox Name="ViewboxBtnColorRedContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                </Controls:UniformGrid>
                                                            </ui:SimpleStackPanel>
                                                            <ui:SimpleStackPanel Height="55" Orientation="Horizontal" Width="270">
                                                                <Controls:UniformGrid Columns="4" Width="270">
                                                                    <Border x:Name="BorderPenColorYellow" Background="#F38B00" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorYellow_Click">
                                                                        <Viewbox x:Name="ViewboxBtnColorYellowContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorGreen" Background="#169141" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorGreen_Click">
                                                                        <Viewbox Name="ViewboxBtnColorGreenContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorBlue" Background="#239AD6" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorBlue_Click">
                                                                        <Viewbox x:Name="ViewboxBtnColorBlueContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                    <Border x:Name="BorderPenColorPink" Background="#c72ec7" BorderBrush="Black" BorderThickness="1.5" CornerRadius="15" Width="55" MouseUp="BtnColorPink_Click">
                                                                        <Viewbox x:Name="ViewboxBtnColorPinkContent" Visibility="Collapsed" Margin="6">
                                                                            <ui:SymbolIcon Symbol="Accept" Foreground="White"/>
                                                                        </Viewbox>
                                                                    </Border>
                                                                </Controls:UniformGrid>
                                                            </ui:SimpleStackPanel>
                                                        </Controls:UniformGrid>
                                                    </Border>
                                                </ui:SimpleStackPanel>
                                            </StackPanel>
                                        </Viewbox>
                                    </Border>
                                </Grid>
                            </ui:SimpleStackPanel>

                            <ui:SimpleStackPanel Name="Eraser_Icon" MouseUp="EraserIcon_Click" MouseDown="Border_MouseDown" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-png/eraser-outline.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel Name="EraserByStrokes_Icon" MouseUp="EraserIconByStrokes_Click" MouseDown="Border_MouseDown" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-png/eraser-line.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel Name="SymbolIconSelect" MouseDown="Border_MouseDown" MouseUp="SymbolIconSelect_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_lasso_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="ImageDrawShape_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_shapes_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="23" Width="28"/>
                            </ui:SimpleStackPanel>

                            <Grid Width="0">
                                <Border x:Name="BorderDrawShape" Visibility="Visible" Background="White" Opacity="0.9" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1"
                                    CornerRadius="5" Margin="-112,-262,-88,27" Height="240">
                                    <Viewbox>
                                        <ui:SimpleStackPanel Spacing="-8" Orientation="Vertical">
                                            <TextBlock FontSize="16" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Left" Margin="10,8">
                                                <Run Text="图形"/>
                                                <Run Text="(第一行支持长按保持选中)" FontSize="10"/>
                                            </TextBlock>
                                            <ui:SymbolIcon Margin="0,-20,8,15" Symbol="Pin" MouseDown="Border_MouseDown" MouseUp="SymbolIconPinBorderDrawShape_MouseUp" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Right"/>
                                            <ui:SimpleStackPanel Height="50" Spacing="14" Orientation="Horizontal">
                                                <Image Name="BoardImageDrawLine" Margin="16,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawLine_Click" Source="{DynamicResource DrawShapeImageSource.Line}"/>
                                                <Image Name="BoardImageDrawDashedLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDashedLine_Click" Source="{DynamicResource DrawShapeImageSource.DashedLine}"/>
                                                <Image Name="BoardImageDrawDotLine" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawDotLine_Click" Source="{DynamicResource DrawShapeImageSource.DotLine}"/>
                                                <Image Name="BoardImageDrawArrow" Margin="0,12,0,12" MouseDown="Image_MouseDown" MouseUp="BtnDrawArrow_Click" Source="{DynamicResource DrawShapeImageSource.ArrowLine}"/>
                                                <Image Name="BoardImageDrawParallelLine" Margin="0,11.5,16,11.5" MouseDown="Image_MouseDown" MouseUp="BtnDrawParallelLine_Click" Source="{DynamicResource DrawShapeImageSource.ParallelLine}"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="15" Orientation="Horizontal">
                                                <Image Margin="16,12,0,12" MouseUp="BtnDrawCoordinate1_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate1}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate2_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate2}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate3_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate3}"/>
                                                <Image Margin="0,12" MouseUp="BtnDrawCoordinate4_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate4}"/>
                                                <Image Margin="-1,11.5" MouseUp="BtnDrawCoordinate5_Click" Source="{DynamicResource DrawShapeImageSource.Coordinate5}"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,11,2,11" MouseUp="BtnDrawRectangleCenter_Click" Source="{DynamicResource DrawShapeImageSource.RectangleCenter}"/>
                                                <Image Visibility="Collapsed" Margin="0,10" MouseUp="BtnDrawEllipse_Click" Source="{DynamicResource DrawShapeImageSource.Ellipse}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCircle_Click" Source="{DynamicResource DrawShapeImageSource.Circle}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawDashedCircle_Click" Source="{DynamicResource DrawShapeImageSource.DashedCircle}"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipse_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenter}" Width="30"/>
                                                <Image Margin="0,10" MouseUp="BtnDrawCenterEllipseWithFocalPoint_Click" Source="{DynamicResource DrawShapeImageSource.EllipseCenterWithFocalPoint}" Width="30"/>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="16,10,2,10" MouseUp="BtnDrawHyperbola_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Hyperbola}"/>
                                                <Image Margin="4,10,2,10" MouseUp="BtnDrawHyperbolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.HyperbolaWithFocalPoint}"/>
                                                <Image Margin="2.5,10,2,10" MouseUp="BtnDrawParabola1_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}"/>
                                                <Image Margin="1,10,2,10" MouseUp="BtnDrawParabolaWithFocalPoint_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.ParabolaWithFocalPoint}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform Angle="90"/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                                <Image Margin="2,10,2,10" MouseUp="BtnDrawParabola2_Click" Width="26" Source="{DynamicResource DrawShapeImageSource.Parabola}" RenderTransformOrigin="0.5,0.5">
                                                    <Image.RenderTransform>
                                                        <TransformGroup>
                                                            <ScaleTransform/>
                                                            <SkewTransform/>
                                                            <RotateTransform Angle="90"/>
                                                            <TranslateTransform/>
                                                        </TransformGroup>
                                                    </Image.RenderTransform>
                                                </Image>
                                            </ui:SimpleStackPanel>
                                            <ui:SimpleStackPanel Height="50" Spacing="10" Orientation="Horizontal">
                                                <Image Margin="15,11,2,11" MouseUp="BtnDrawRectangle_Click" Source="{DynamicResource DrawShapeImageSource.Rectangle}"/>
                                                <Image Margin="6,10,2,10" MouseUp="BtnDrawCylinder_Click" Source="{DynamicResource DrawShapeImageSource.Cylinder}"/>
                                                <Image Margin="8,12.5,0,10" MouseUp="BtnDrawCone_Click" Source="{DynamicResource DrawShapeImageSource.Cone}"/>
                                                <Image Margin="5.5,12.5,2.5,10" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Cuboid}"/>
                                                <Image Visibility="Collapsed" Margin="0,11.5,2.5,9.5" MouseUp="BtnDrawCuboid_Click" Source="{DynamicResource DrawShapeImageSource.Tetrahedron}"/>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </Viewbox>
                                </Border>
                            </Grid>
                            <ui:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconUndo_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center" IsEnabled="{Binding ElementName=BtnUndo, Path=IsEnabled}">
                                <Image Source="/Resources/Icons-png/undo.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="28" Opacity="{Binding ElementName=BtnUndo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconRedo_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center" IsEnabled="{Binding ElementName=BtnRedo, Path=IsEnabled}">
                                <Image Source="/Resources/Icons-png/redo.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="28" Opacity="{Binding ElementName=BtnRedo, Path=IsEnabled, Converter={StaticResource IsEnabledToOpacityConverter}}"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="CursorWithDelIcon_Click"
                                                 Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Margin="-1,0,2,0" Source="/Resources/Icons-Fluent/ic_fluent_cursorWITHdelete_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="24" Width="26"/>
                            </ui:SimpleStackPanel>
                        </ui:SimpleStackPanel>
                        <ui:SimpleStackPanel Orientation="{Binding ElementName=StackPanelFloatingBar, Path=Orientation}">
                            <Border Margin="0,2" BorderBrush="Black" BorderThickness="1,0,0,0" MouseDown="Border_MouseDown" MouseUp="ImageBlackboard_MouseUp">
                                <Image Margin="2,0,0,0" Source="/Resources/Icons-Fluent/ic_fluent_whiteboard_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                            </Border>
                            <ui:SimpleStackPanel MouseDown="Border_MouseDown" MouseUp="SymbolIconTools_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-png/setting.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="28"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel x:Name="Fold_Icon" MouseDown="Border_MouseDown" MouseUp="FoldFloatingBar_MouseUp" Background="Transparent" Orientation="Horizontal" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_dual_screen_span_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="28"/>
                            </ui:SimpleStackPanel>
                            <Grid Width="0">
                                <Border Name="BorderTools" Margin="-117,-148,-35,40" CornerRadius="5" Background="White" Opacity="0.9" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}">
                                    <ui:SimpleStackPanel>
                                        <Image HorizontalAlignment="Right" Margin="0,2,2,-27" Source="/Resources/Icons-png/close-circle.png" RenderOptions.BitmapScalingMode="HighQuality" Height="25" Width="25" MouseDown="Border_MouseDown" MouseUp="CloseBordertools_MouseUp"/>
                                        <ui:SimpleStackPanel Margin="10">
                                            <Label Content="倒计时   抽选   单次抽选" FontSize="9.5" Foreground="{DynamicResource FloatBarForeground}" HorizontalAlignment="Left"/>
                                            <ui:SimpleStackPanel Margin="2.5,0,0,2" Height="25" Spacing="13" Orientation="Horizontal">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_timer_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="22" MouseDown="Border_MouseDown" MouseUp="ImageCountdownTimer_MouseUp"/>
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_people_money_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="SymbolIconRand_MouseUp"/>
                                                <Image Margin="1,0,0,0" Source="/Resources/Icons-Fluent/ic_fluent_person_money_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="SymbolIconRandOne_MouseUp"/>
                                            </ui:SimpleStackPanel>
                                            <Label Content="保存 | 打开 | 播放 - 墨迹" FontSize="12" HorizontalAlignment="Left"/>
                                            <ui:SimpleStackPanel Orientation="Horizontal" Margin="2.5,0,0,0" Height="25" Spacing="15">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_save_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="SymbolIconSaveStrokes_MouseUp"/>
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_folder_open_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="SymbolIconOpenStrokes_MouseUp"/>
                                                <Image Source="/Resources/Icons-png/playCircle.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="GridInkReplayButton_MouseUp"/>
                                            </ui:SimpleStackPanel>
                                            <Label Content="截图 | 设置 | 指南" FontSize="12.25" HorizontalAlignment="Left"/>
                                            <ui:SimpleStackPanel Orientation="Horizontal" Margin="2.5,0,0,0" Height="25" Spacing="14.5">
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_camera_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20" MouseDown="Border_MouseDown" MouseUp="SymbolIconScreenshot_MouseUp" Margin="0,2,0,3"/>
                                                <Image Source="/Resources/Icons-Fluent/ic_fluent_settings_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="22" MouseDown="Border_MouseDown" MouseUp="SymbolIconSettings_Click"/>
                                                <!--<Image Margin="-1,0,0,0" x:Name="hiddenButtonInBorderTools" Source="/Resources/Icons-Fluent/ic_fluent_dual_screen_span_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="22" MouseDown="Border_MouseDown" MouseUp="FoldFloatingBar_MouseUp"/>-->
                                                <Image Margin="-1.5,0,0,0" Source="/Resources/Icons-Fluent/ic_fluent_book_question_mark_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="22" Width="22" MouseDown="Border_MouseDown" MouseUp="OperatingGuideWindowIcon_MouseUp"/>
                                            </ui:SimpleStackPanel>
                                        </ui:SimpleStackPanel>
                                    </ui:SimpleStackPanel>
                                </Border>
                            </Grid>
                        </ui:SimpleStackPanel>
                    </ui:SimpleStackPanel>
                </Border>


                <Border Margin="2,0,0,0" x:Name="EnableTwoFingerGestureBorder" Visibility="Visible" Width="36" Height="36" MouseUp="TwoFingerGestureBorder_MouseUp" CornerRadius="5" Background="{DynamicResource FloatBarBackground}" BorderBrush="{DynamicResource FloatBarBorderBrush}" BorderThickness="1" >
                    <Image x:Name="EnableTwoFingerGestureBtn" Source="/Resources/Icons-png/twoFingelMove.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="30"/>
                </Border>
                <Grid Width="0">
                    <Border Name="TwoFingerGestureBorder" Visibility="Visible" Margin="-105,-158,-67,44" CornerRadius="5" Background="white" Opacity="0.9" BorderBrush="Black" BorderThickness="1">
                        <ui:SimpleStackPanel Margin="10">
                            <ui:SimpleStackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_people_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                <Label Content="多指书写" FontSize="15" VerticalAlignment="Center"/>
                                <ui:ToggleSwitch MinWidth="0" Width="42" Name="ToggleSwitchEnableMultiTouchMode" FontFamily="Microsoft YaHei UI" IsOn="False" OnContent="" OffContent="" Toggled="ToggleSwitchEnableMultiTouchMode_Toggled"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel Opacity="1" x:Name="TwoFingerGestureSimpleStackPanel" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_drag_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                <Label Content="双指移动" FontSize="15" VerticalAlignment="Center"/>
                                <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent="" Name="ToggleSwitchEnableTwoFingerTranslate" FontFamily="Microsoft YaHei UI" IsOn="False" Toggled="ToggleSwitchEnableTwoFingerTranslate_Toggled"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_scale_fit_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                <Label Content="双指缩放" FontSize="15" VerticalAlignment="Center"/>
                                <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent="" Name="ToggleSwitchEnableTwoFingerZoom" FontFamily="Microsoft YaHei UI" IsOn="False" Toggled="ToggleSwitchEnableTwoFingerZoom_Toggled"/>
                            </ui:SimpleStackPanel>
                            <ui:SimpleStackPanel Opacity="{Binding ElementName=TwoFingerGestureSimpleStackPanel, Path=Opacity}" Orientation="Horizontal" Spacing="8" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Image Source="/Resources/Icons-Fluent/ic_fluent_arrow_rotate_clockwise_24_regular.png" RenderOptions.BitmapScalingMode="HighQuality" Height="20" Width="20"/>
                                <Label Content="双指旋转" FontSize="15" VerticalAlignment="Center"/>
                                <ui:ToggleSwitch MinWidth="0" Width="42" OnContent="" OffContent="" Name="ToggleSwitchEnableTwoFingerRotation" FontFamily="Microsoft YaHei UI" Toggled="ToggleSwitchEnableTwoFingerRotation_Toggled"/>
                            </ui:SimpleStackPanel>
                        </ui:SimpleStackPanel>
                    </Border>
                </Grid>

                <Border x:Name="BorderFloatingBarExitPPTBtn" Margin="2,0,0,0" Width="34" Height="36" MouseDown="Border_MouseDown" MouseUp="ImagePPTControlEnd_MouseUp"
                        Background="{DynamicResource FloatBarBackground}" CornerRadius="4" BorderThickness="1" BorderBrush="{DynamicResource FloatBarBorderBrush}"
                        Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}">
                    <Grid>
                        <Image Source="{DynamicResource ResourceKey=SeewoImageSource.PPTExitNormal}" Visibility="{Binding ElementName=BtnPPTSlideShowEnd, Path=Visibility}" Height="20" Width="30" />
                    </Grid>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>

        <Grid Name="GridForFloatingBarDraging" Background="#01000000" Visibility="Collapsed"
              MouseMove="SymbolIconEmoji_MouseMove" MouseUp="SymbolIconEmoji_MouseUp"/>

        <InkCanvas Name="InkCanvasForInkReplay" MouseDown="InkCanvasForInkReplay_MouseDown" Visibility="Collapsed" EditingMode="None" Background="Transparent"/>

        <!--// 侧边栏 //-->
        <Viewbox x:Name="LeftSidePanel" MouseUp="UnFoldFloatingBar_MouseUp" Visibility="Visible" Height="50" Width="30" Margin="-40,0,0,-150" HorizontalAlignment="Left" VerticalAlignment="Center">
            <ui:SimpleStackPanel>
                <Border Background="LightGray" Opacity="0.4" CornerRadius="0,5,5,0" Height="50" Width="30">
                    <Image Margin="0,0,-15,0" Source="/Resources/Icons-png/penUpright.png" RenderOptions.BitmapScalingMode="HighQuality" Height="50" Width="30"/>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>
        <Viewbox x:Name="RightSidePanel" MouseUp="UnFoldFloatingBar_MouseUp" Visibility="{Binding ElementName=LeftSidePanel, Path=Visibility}" Height="50" Width="30" Margin="0,0,-40,-150" HorizontalAlignment="Right" VerticalAlignment="Center">
            <ui:SimpleStackPanel>
                <Border Background="LightGray" Opacity="0.4" CornerRadius="5,0,0,5" Height="50" Width="30">
                    <Image Margin="-15,0,0,0" Source="/Resources/Icons-png/penUpright.png" RenderOptions.BitmapScalingMode="HighQuality" Height="50" Width="30"/>
                </Border>
            </ui:SimpleStackPanel>
        </Viewbox>
    </Grid>
</Window>
